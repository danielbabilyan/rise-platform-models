generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model Platform {
  id          Int          @id @default(autoincrement()) @db.UnsignedInt
  account_id  Int          @db.UnsignedInt
  name        PlatformName
  meta        Json
  created_at  DateTime     @default(now())
  updated_at  DateTime     @updatedAt
  account     Account      @relation(fields: [account_id], references: [id])
  @@map("platforms")
}

model Profile {
  id            Int      @id @default(autoincrement()) @db.UnsignedInt
  sub           String   @db.VarChar(128) @unique
  email         String   @db.VarChar(128)
  name          String   @db.VarChar(128)
  profile_image String?  @db.MediumText
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt
  users          User[]
  @@map("profiles")
}

model User {
  id          Int        @id @default(autoincrement()) @db.UnsignedInt
  profile_id  Int        @db.UnsignedInt
  account_id  Int        @db.UnsignedInt
  permissions Json
  status      UserStatus
  is_admin    Boolean?   @default(false)
  created_at  DateTime   @default(now())
  updated_at  DateTime   @updatedAt
  profile     Profile    @relation(fields: [profile_id], references: [id])
  account     Account    @relation(fields: [account_id], references: [id])
  @@map("users")
}

model Account {
  id         Int        @id @default(autoincrement()) @db.UnsignedInt
  name       String     @db.VarChar(128)
  licenses   Json
  created_at DateTime   @default(now())
  updated_at DateTime   @updatedAt
  platforms  Platform[] 
  users      User[]
  @@map("accounts")
}

enum PlatformName {
  SHOPIFY
  AMAZON
  SQUARE
}

enum UserStatus {
  ACTIVE
  DISABLED
  INVITED
}